I need to integrate Spotify Web API for music functionality. Here are the details:

Project Details:

- Tech stack: [e.g., React + Node.js, Next.js, mobile app, etc.]
- Features needed: [music search, playlists, user library, playback control, recommendations]
- User interaction: [login with Spotify, create playlists, control playback, social features]
- Playback method: [Web Playback SDK, embedded player, external app redirect]
- Data usage: [track info, artist data, playlist management, user preferences]
- Authorization scope: [read user data, modify playlists, control playback]
- Integration depth: [basic embedding, full music app, recommendation engine]
- Commercial usage: [personal project, commercial app, revenue model]

What I need:

1. Spotify App registration and OAuth setup
2. Authentication flow implementation (Authorization Code)
3. Web Playback SDK integration for in-app playback
4. Search API implementation (tracks, artists, playlists)
5. User library and playlist management
6. Recommendation and discovery features
7. Real-time playback controls and state management
8. Error handling and token refresh
9. Rate limiting and API best practices
10. Compliance with Spotify Developer Terms

Additional context: [app type, commercial usage, specific Spotify features needed]

Please provide a complete working example with detailed comments.
